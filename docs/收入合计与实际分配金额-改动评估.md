# 收入合计 / 实际分配金额 — 改动方案与范围评估

## 一、概念对齐

| 业务用语 | 含义 | 当前系统字段 | 计算公式 |
|----------|------|--------------|----------|
| **收入合计** | 补油款、奖罚之前的全部收入 | `revenue`（营业额） | 5转收入 + 微信收入 |
| **营业额** | 与上同义 | `revenue` | 同上 |
| **实际分配金额** | 算上补油款、奖罚之后参与分配的钱 | `net_income`（净收入） | 营业额 − 补油款 + 奖罚 |

结论：**现有库表与计算逻辑已满足需求**，无需新增字段或改公式。只需在展示和文案上统一“收入合计”“实际分配金额”的称谓。

---

## 二、是否需要改数据库

**结论：不需要改表结构。**

- `daily_incomes.revenue`：已是「5转+微信」，对应 **收入合计/营业额**。
- `daily_incomes.net_income`：已是「营业额−补油款+奖罚」，对应 **实际分配金额**。
- `daily_statistics` 的 `total_revenue` / `total_net_income`、`average_revenue` / `average_net_income` 含义一致，无需新增字段。

可选：在**注释**中写清业务名，便于后续维护（见下文「后端」）。

---

## 三、改动范围建议

### 1. 后端（可选，仅注释/文档）

| 位置 | 建议 |
|------|------|
| `daily_incomes` 表 / 模型注释 | 注明：revenue = 营业额（收入合计），net_income = 净收入（实际分配金额） |
| `daily_statistics` 表 / 模型注释 | 同上，总营业额=收入合计之和，总净收入=实际分配金额之和 |
| API 响应 | 保持字段名 `revenue` / `net_income` 不变，避免前端兼容和已有对接方受影响 |

不新增接口、不删改字段，仅文档/注释统一即可。

### 2. 前端（必做，展示与文案）

| 位置 | 改动内容 |
|------|----------|
| **收入录入 Tab** | 列表/展开区：在“营业额”旁补充“（收入合计）”；在“净收入”旁补充“（实际分配金额）”或直接改为“实际分配金额”，并保留一处说明：收入合计=5转+微信，实际分配金额=收入合计−补油款+奖罚。 |
| **统计 Tab** | 概览卡片：总营业额可标为“总营业额（收入合计）”，总净收入可标为“总净收入（实际分配金额）”或“总实际分配金额”；车辆详情表头同理。 |
| **文案/帮助** | 在录入页或统计页增加一句说明：**收入合计 = 5转收入+微信收入；实际分配金额 = 收入合计−补油款+奖罚**。 |

实现方式建议：

- 列头/卡片标题：用「营业额（收入合计）」「净收入（实际分配金额）」或单独用「收入合计」「实际分配金额」。
- 不改变请求/响应字段名，仍用 `revenue` / `net_income`，仅改展示文案。

### 3. 类型定义与接口

- `typings.d.ts`、API 请求/响应：**保持 `revenue`、`net_income` 不变**，无需为“收入合计”“实际分配金额”新增字段。
- 若后续有导出 Excel 等，表头用中文「收入合计」「实际分配金额」即可。

---

## 四、小结

| 项目 | 是否改动 | 说明 |
|------|----------|------|
| 数据库表结构 | 否 | 现有字段已对应收入合计、实际分配金额 |
| 后端计算逻辑 | 否 | 公式已正确 |
| 后端注释/文档 | 建议 | 注明 revenue=收入合计/营业额，net_income=实际分配金额/净收入 |
| 前端展示与文案 | 是 | 统一使用“收入合计”“实际分配金额”并加简短说明 |
| API 字段名 | 否 | 保持 `revenue` / `net_income`，避免兼容问题 |

整体为**文案与展示统一**，**无数据库迁移、无接口破坏性变更**，改动范围小、风险低。
